#include <Windows.h>
#include <stdio.h>


int main()
{
	//HANDLE hControl = CreateSemaphoreW(NULL, 1, 1, L"secret@@@");
	//HANDLE hControl = CreateMutexW(NULL, FALSE, L"secret@@@");
	HANDLE hControl = CreateEventW(NULL, FALSE, FALSE, L"secret@@@");

	if (hControl != NULL && GetLastError() == ERROR_ALREADY_EXISTS)
	{
		wprintf(L"[!] Payload is already running\n");
	}
	else 
	{
		wprintf(L"[i] This is the FIRST copy of the payload running\n");
	}

	wprintf(L"[#] Press any key to continue... ");
	getchar();

	return 0;
}