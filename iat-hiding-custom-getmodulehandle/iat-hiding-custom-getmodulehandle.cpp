#include <Windows.h>
#include "misc.h"
#include "iat-hiding-custom-getmodulehandle-lib.h"

#define MODNAME L"KeRNEL32.DLL"
// kernel32.dll -> djb_hash: 0x9ef6cca9

int main()
{
	PVOID pFunOrig = GetModuleHandle(MODNAME);
	wprintf(L"[*] GetModuleHandle Original: 0x%p\n", pFunOrig);
	
	PVOID pFunCustom = GetModuleHandleCustom(0x9ef6cca9);		
	wprintf(L"[*] GetModuleHandle Custom: 0x%p\n", pFunCustom);

	return 0;
}

