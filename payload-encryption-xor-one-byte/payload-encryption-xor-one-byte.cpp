#include <windows.h>
#include <stdio.h>
#include "misc.h"


void xorOneByte(PBYTE pData, SIZE_T sDataSize, BYTE key)
{
	for (size_t i = 0; i < sDataSize; i++)
	{
		pData[i] = pData[i] ^ key;
	}
}

int main()
{
	// msfvenom -p windows/exec CMD=notepad.exe -f c
	BYTE bufEnc[] =
		"\x03\x17\x7d\xff\xff\xff\x9f\x76\x1a\xce\x3f\x9b\x74\xaf\xcf\x74"
		"\xad\xf3\x74\xad\xeb\x74\x8d\xd7\xf0\x48\xb5\xd9\xce\x00\x53\xc3"
		"\x9e\x83\xfd\xd3\xdf\x3e\x30\xf2\xfe\x38\x1d\x0d\xad\xa8\x74\xad"
		"\xef\x74\xb5\xc3\x74\xb3\xee\x87\x1c\xb7\xfe\x2e\xae\x74\xa6\xdf"
		"\xfe\x2c\x74\xb6\xe7\x1c\xc5\xb6\x74\xcb\x74\xfe\x29\xce\x00\x53"
		"\x3e\x30\xf2\xfe\x38\xc7\x1f\x8a\x09\xfc\x82\x07\xc4\x82\xdb\x8a"
		"\x1b\xa7\x74\xa7\xdb\xfe\x2c\x99\x74\xf3\xb4\x74\xa7\xe3\xfe\x2c"
		"\x74\xfb\x74\xfe\x2f\x76\xbb\xdb\xdb\xa4\xa4\x9e\xa6\xa5\xae\x00"
		"\x1f\xa0\xa0\xa5\x74\xed\x14\x72\xa2\x95\xfe\x72\x7a\x4d\xff\xff"
		"\xff\xaf\x97\xce\x74\x90\x78\x00\x2a\x44\x0f\x4a\x5d\xa9\x97\x59"
		"\x6a\x42\x62\x00\x2a\xc3\xf9\x83\xf5\x7f\x04\x1f\x8a\xfa\x44\xb8"
		"\xec\x8d\x90\x95\xff\xac\x00\x2a\x91\x90\x8b\x9a\x8f\x9e\x9b\xd1"
		"\x9a\x87\x9a\xff";

	SIZE_T sBufEnc = (sizeof(bufEnc) / sizeof(BYTE)) - 1;

	
	printHex(bufEnc, sBufEnc);

	xorOneByte(bufEnc, sBufEnc, '\xFF');

	printHex(bufEnc, sBufEnc);


	return 0;
}